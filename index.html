<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CampusConnect এ স্বাগতম</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-md">
        <!-- Login Form -->
        <div id="login-view" class="bg-white shadow-lg rounded-lg px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl mb-6 text-center font-bold text-gray-800">লগইন করুন</h2>
            <form id="login-form">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="login-email">ইমেল</label>
                    <input class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="login-email" type="email" placeholder="আপনার ইমেল" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="login-password">পাসওয়ার্ড</label>
                    <input class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="login-password" type="password" placeholder="********" required>
                </div>
                <div class="flex items-center justify-between">
                    <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">সাইন ইন</button>
                    <a class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800" href="#" id="show-signup">অ্যাকাউন্ট নেই? সাইন আপ</a>
                </div>
            </form>
        </div>

        <!-- Signup Form (Hidden by default) -->
        <div id="signup-view" class="hidden bg-white shadow-lg rounded-lg px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl mb-6 text-center font-bold text-gray-800">অ্যাকাউন্ট তৈরি করুন</h2>
            <form id="signup-form">
                <div class="mb-4"><input class="shadow appearance-none border rounded w-full py-3 px-4" id="signup-name" type="text" placeholder="পুরো নাম" required></div>
                <div class="mb-4"><input class="shadow appearance-none border rounded w-full py-3 px-4" id="signup-roll" type="text" placeholder="রোল নম্বর / আইডি" required></div>
                <div class="mb-4"><input class="shadow appearance-none border rounded w-full py-3 px-4" id="signup-email" type="email" placeholder="ইমেল" required></div>
                <div class="mb-6"><input class="shadow appearance-none border rounded w-full py-3 px-4" id="signup-password" type="password" placeholder="পাসওয়ার্ড (কমপক্ষে ৬ অক্ষর)" required></div>
                <div class="flex items-center justify-between">
                    <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">সাইন আপ</button>
                    <a class="inline-block align-baseline font-bold text-sm text-green-500 hover:text-green-800" href="#" id="show-login">ইতিমধ্যে অ্যাকাউন্ট আছে?</a>
                </div>
            </form>
        </div>
        <p id="error-message" class="text-red-500 text-xs italic text-center mt-4"></p>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        // !!! খুবই গুরুত্বপূর্ণ: আপনার নিজের Firebase কনফিগারেশন কোডটি নিচে পেস্ট করুন !!!
       // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDZ2_WsSGU_xM3IUa2-rqKK1YppIXI-SoY",
  authDomain: "campusconnect-a8447.firebaseapp.com",
  databaseURL: "https://campusconnect-a8447-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "campusconnect-a8447",
  storageBucket: "campusconnect-a8447.firebasestorage.app",
  messagingSenderId: "512467118728",
  appId: "1:512467118728:web:2c8cb155422e6e181d0d3d",
  measurementId: "G-62XR5TLSN7"
};
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const loginView = document.getElementById('login-view');
        const signupView = document.getElementById('signup-view');
        const showSignupBtn = document.getElementById('show-signup');
        const showLoginBtn = document.getElementById('show-login');
        const errorMessage = document.getElementById('error-message');

        showSignupBtn.addEventListener('click', () => { loginView.classList.add('hidden'); signupView.classList.remove('hidden'); });
        showLoginBtn.addEventListener('click', () => { signupView.classList.add('hidden'); loginView.classList.remove('hidden'); });
        
        document.getElementById('login-form').addEventListener('submit', e => {
            e.preventDefault();
            const email = e.target['login-email'].value;
            const password = e.target['login-password'].value;
            auth.signInWithEmailAndPassword(email, password)
                .then(() => window.location.href = 'dashboard.html')
                .catch(err => errorMessage.textContent = err.message);
        });
        
        document.getElementById('signup-form').addEventListener('submit', e => {
            e.preventDefault();
            const name = e.target['signup-name'].value;
            const roll = e.target['signup-roll'].value;
            const email = e.target['signup-email'].value;
            const password = e.target['signup-password'].value;
            
            auth.createUserWithEmailAndPassword(email, password)
                .then(cred => {
                    return db.collection('users').doc(cred.user.uid).set({
                        name: name, email: email, roll: roll,
                        status: 'pending', role: 'student'
                    });
                })
                .then(() => window.location.href = 'dashboard.html')
                .catch(err => errorMessage.textContent = err.message);
        });

        auth.onAuthStateChanged(user => {
            if (user) { window.location.href = 'dashboard.html'; }
        });
    </script>
</body>
</html>